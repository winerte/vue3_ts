import{m as B,d as ee,n as s,i as le,p as q,q as ae,c as F,g as l,w as a,r as p,F as $,j as n,s as k,k as d,b as te,o as S,f as oe,t as ne,_ as ue}from"./index-Du_Ei7i5.js";const de=(y,f,g)=>B.get(`admin/acl/user/${y}/${f}?username=${g}`),se=y=>B.post("admin/acl/user/save",y),re=y=>B.get(`admin/acl/user/toAssign/${y}`),pe=ee({__name:"index",setup(y){let f=s(5),g=s(1),v=s("");le();let D=s([]),R=s(0),V=s(!1),b=q({id:0,username:"",name:"",password:""});ae(()=>{w(g.value,f.value,v.value)});const w=async(o,e,i)=>{let u=await de(o,e,i);u.code==200&&(o=u.data.current,e=u.data.size,R.value=u.data.total,D.value=u.data.records)},h=()=>{V.value=!0},T=async()=>{await se(b),w(g.value,f.value,v.value)},E=o=>{f.value=o,w(g.value,f.value,v.value)},M=o=>{g.value=o,w(g.value,f.value,v.value)},G=()=>{console.log("批量删除"+I.value)};let I=s([]);const H=o=>{I.value=o.map(e=>e.id)},J=o=>{console.log(o)};let C=s(!1),c=s([]),m=s([]),x=s(!1),U=q({id:0,username:"",name:"",password:""}),N=s(!0);const z=()=>{const o=m.value.length;x.value=o===c.value.length,N.value=o>0&&o<c.value.length},K=o=>{m.value=o,z()},O=o=>{o?m.value=c.value.map(e=>e.roleName):m.value=[],N.value=!1,z()},Q=async o=>{U=o;let e=await re(o.id);e.code==200&&(c.value=e.data.allRolesList,m.value=e.data.assignRoles.map(i=>i.roleName),z(),C.value=!0)};return(o,e)=>{const i=p("el-input"),u=p("el-form-item"),r=p("el-button"),A=p("el-form"),L=p("el-card"),_=p("el-table-column"),W=p("el-table"),X=p("el-pagination"),P=p("el-drawer"),j=p("el-checkbox"),Y=p("el-checkbox-group");return S(),F($,null,[l(L,{style:{height:"10%"}},{default:a(()=>[l(A,{class:"cadr_up"},{default:a(()=>[l(u,{label:"用户名"},{default:a(()=>[l(i,{modelValue:n(v),"onUpdate:modelValue":e[0]||(e[0]=t=>k(v)?v.value=t:v=t),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(r,{type:"primary"},{default:a(()=>e[9]||(e[9]=[d("搜索")])),_:1,__:[9]}),l(r,null,{default:a(()=>e[10]||(e[10]=[d("重置")])),_:1,__:[10]})]),_:1})]),_:1})]),_:1}),l(L,{class:"card_down",style:{"margin-top":"10px"}},{default:a(()=>[l(r,{type:"primary",onClick:h},{default:a(()=>e[11]||(e[11]=[d("添加")])),_:1,__:[11]}),l(r,{type:"danger",onClick:G},{default:a(()=>e[12]||(e[12]=[d("批量删除")])),_:1,__:[12]}),l(W,{data:n(D),border:"",style:{width:"100%",margin:"10px 0"},onSelectionChange:H},{default:a(()=>[l(_,{type:"selection"}),l(_,{type:"index"}),l(_,{prop:"id",label:"id",width:"80px"}),l(_,{prop:"username",label:"用户名字",width:"80px"}),l(_,{prop:"name",label:"用户名称",width:"80px"}),l(_,{prop:"roleName",label:"用户角色"}),l(_,{prop:"createTime",label:"创建时间",width:"120px"}),l(_,{prop:"updateTime",label:"更新时间",width:"120px"}),l(_,{label:"操作"},{default:a(({row:t,$index:me})=>[l(r,{type:"primary",onClick:Z=>Q(t)},{default:a(()=>e[13]||(e[13]=[d("分配角色")])),_:2,__:[13]},1032,["onClick"]),l(r,{type:"primary",onClick:Z=>J(t)},{default:a(()=>e[14]||(e[14]=[d("编辑")])),_:2,__:[14]},1032,["onClick"]),l(r,{type:"danger"},{default:a(()=>e[15]||(e[15]=[d("删除")])),_:1,__:[15]})]),_:1})]),_:1},8,["data"]),l(X,{onSizeChange:E,onCurrentChange:M,"current-page":n(g),"page-sizes":[3,5,10,15],"page-size":n(f),layout:" prev, pager, next, jumper,-> ,total, sizes,",total:n(R)},null,8,["current-page","page-size","total"]),l(P,{title:"添加/修改-用户",modelValue:n(V),"onUpdate:modelValue":e[4]||(e[4]=t=>k(V)?V.value=t:V=t)},{default:a(()=>[l(A,{model:n(b)},{default:a(()=>[l(u,{label:"用户姓名"},{default:a(()=>[l(i,{modelValue:n(b).username,"onUpdate:modelValue":e[1]||(e[1]=t=>n(b).username=t),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(u,{label:"用户昵称"},{default:a(()=>[l(i,{modelValue:n(b).name,"onUpdate:modelValue":e[2]||(e[2]=t=>n(b).name=t),type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(u,{label:"用户密码"},{default:a(()=>[l(i,{modelValue:n(b).password,"onUpdate:modelValue":e[3]||(e[3]=t=>n(b).password=t),"show-password":""},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(r,{type:"primary",onClick:T},{default:a(()=>e[16]||(e[16]=[d("保存")])),_:1,__:[16]}),l(r,null,{default:a(()=>e[17]||(e[17]=[d("取消")])),_:1,__:[17]})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(P,{title:"分配角色",modelValue:n(C),"onUpdate:modelValue":e[8]||(e[8]=t=>k(C)?C.value=t:C=t)},{default:a(()=>[l(A,{model:n(U)},{default:a(()=>[l(u,{label:"用户姓名"},{default:a(()=>[l(i,{modelValue:n(U).username,"onUpdate:modelValue":e[5]||(e[5]=t=>n(U).username=t),disabled:!0,type:"text",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(u,{label:"职位列表"},{default:a(()=>[l(j,{indeterminate:n(N),modelValue:n(x),"onUpdate:modelValue":e[6]||(e[6]=t=>k(x)?x.value=t:x=t),onChange:O},{default:a(()=>e[18]||(e[18]=[d("全选")])),_:1,__:[18]},8,["indeterminate","modelValue"]),l(Y,{modelValue:n(m),"onUpdate:modelValue":e[7]||(e[7]=t=>k(m)?m.value=t:m=t),onChange:K},{default:a(()=>[(S(!0),F($,null,te(n(c),t=>(S(),oe(j,{label:t.roleName,key:t.roleName},{default:a(()=>[d(ne(t.roleName),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(r,{type:"primary",onClick:T},{default:a(()=>e[19]||(e[19]=[d("保存")])),_:1,__:[19]}),l(r,null,{default:a(()=>e[20]||(e[20]=[d("取消")])),_:1,__:[20]})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})],64)}}}),_e=ue(pe,[["__scopeId","data-v-304feb36"]]);export{_e as default};
