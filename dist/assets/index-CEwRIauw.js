import{y as M,d as Y,q as ie,x as te,m as u,i as ce,p as pe,n as me,f as A,w as t,r as a,g as e,j as o,s as D,c as N,b as j,F as P,e as ee,a as $,k as U,E as _e,o as _,t as ge,l as W,v as X,_ as fe}from"./index-BVwbhfbE.js";import{_ as ve}from"./category.vue_vue_type_script_setup_true_lang-DEuQqlWV.js";import{d as be}from"./index-CtIK9dVq.js";const ye=(v,p,r)=>M.get(`/admin/product/${v}/${p}?category3Id=${r}`),we=()=>M.get("/admin/product/baseSaleAttrList"),Ie=v=>M.get(`/admin/product/spuImageList/${v}`),Se=v=>M.get(`/admin/product/spuSaleAttrList/${v}`),Ce=["src"],ke=["src"],xe=Y({__name:"spuForm",props:{row:{},c3Id:{}},emits:["changeSence"],setup(v,{emit:p}){const r=v;ie(()=>{m(),q()}),te(()=>r.row,()=>{r.row&&(k(r.row.id),L(r.row.id),I.value=r.row.tmId)});let b=u([]);const m=async()=>{let n=await be();n.code===200&&(b.value=n.data)},k=async n=>{let l=await Ie(n);l.code==200&&(f.value=l.data)},L=async n=>{let l=await Se(n);if(l.code==200){w.value=l.data;const V=new Set(l.data.map(s=>s.baseSaleAttrId));g.value=h.value.filter(s=>!V.has(s.id)),g.value.length>0&&(S.value=g.value[0].id)}};let w=u([]),g=u([]),h=u([]);const q=async()=>{let n=await we();n.code==200&&(h.value=n.data)};let I=u(),S=u();const T=ce(),H=pe(()=>({token:T.token||""})),G=u("undefined/admin/product/fileUpload");let J=p;const i=()=>{J("changeSence",0)},c=()=>{console.log("保存成功"),_e.success({message:"恭喜你，这是一条成功消息",type:"success"})};let C=u(!1),z=u("");const x=n=>{C.value=!0,z=n.url};let f=u([]),y=me({imgName:"",imgUrl:"",spuId:r.c3Id});const K=(n,l,V)=>{console.log(r.c3Id),n.code===200&&(y.imgUrl=l.response.data,y.imgName=l.name,y.spuId=r.c3Id,f.value.push(y))},O=()=>{g.value.splice(g.value.findIndex(n=>n.id===S.value),1)};return(n,l)=>{const V=a("el-input"),s=a("el-form-item"),B=a("el-option"),Q=a("el-select"),Z=a("plus"),le=a("el-icon"),ae=a("el-upload"),oe=a("el-dialog"),F=a("el-button"),E=a("el-table-column"),ne=a("el-tag"),se=a("el-table"),de=a("el-form"),ue=a("el-card");return _(),A(ue,null,{default:t(()=>[e(de,{ref:"form",model:n.row,"label-width":"120px"},{default:t(()=>[e(s,{label:"spu名称"},{default:t(()=>[e(V,{modelValue:n.row.spuName,"onUpdate:modelValue":l[0]||(l[0]=d=>n.row.spuName=d)},null,8,["modelValue"])]),_:1}),e(s,{label:"spu品牌"},{default:t(()=>[e(Q,{modelValue:o(I),"onUpdate:modelValue":l[1]||(l[1]=d=>D(I)?I.value=d:I=d),placeholder:"请选择",style:{width:"200px"}},{default:t(()=>[(_(!0),N(P,null,j(o(b),(d,R)=>(_(),A(B,{key:R,label:d.tmName,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"spu描述"},{default:t(()=>[e(V,{type:"textarea",autosize:"",placeholder:"请输入内容",modelValue:n.row.description,"onUpdate:modelValue":l[2]||(l[2]=d=>n.row.description=d)},null,8,["modelValue"])]),_:1}),e(s,{label:"spu照片"},{default:t(()=>[o(f).length<0?(_(),A(ae,{key:0,action:G.value,headers:H.value,"list-type":"picture-card","on-preview":x,"on-success":K},{default:t(()=>[e(le,null,{default:t(()=>[e(Z)]),_:1})]),_:1},8,["action","headers"])):ee("",!0),e(oe,{modelValue:o(C),"onUpdate:modelValue":l[3]||(l[3]=d=>D(C)?C.value=d:C=d)},{default:t(()=>[$("img",{width:"100%",src:o(z),alt:""},null,8,Ce)]),_:1},8,["modelValue"]),o(f).length>0?(_(!0),N(P,{key:1},j(o(f),(d,R)=>(_(),N("img",{style:{margin:"10px"},src:d.imgUrl,alt:""},null,8,ke))),256)):ee("",!0)]),_:1}),e(s,{label:"spu销售属性"},{default:t(()=>[e(Q,{modelValue:o(S),"onUpdate:modelValue":l[4]||(l[4]=d=>D(S)?S.value=d:S=d),placeholder:"请选择",style:{width:"200px"}},{default:t(()=>[(_(!0),N(P,null,j(o(g),d=>(_(),A(B,{label:d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),e(F,{type:"primary",icon:"plus",disabled:!(o(g).length>0),style:{"margin-left":"10px"},onClick:O},{default:t(()=>l[5]||(l[5]=[U("添加")])),_:1,__:[5]},8,["disabled"]),e(se,{data:o(w),border:"",style:{margin:"10px 0"},width:"100%"},{default:t(()=>[e(E,{type:"index",label:"序号",width:"80"}),e(E,{label:"属性名",prop:"saleAttrName"}),e(E,{label:"属性值"},{default:t(d=>[(_(!0),N(P,null,j(d.row.spuSaleAttrValueList,(R,re)=>(_(),A(ne,{key:re,style:{"margin-right":"8px"}},{default:t(()=>[U(ge(R.saleAttrValueName),1)]),_:2},1024))),128))]),_:1}),e(E,{label:"操作"},{default:t(()=>[e(F,{type:"primary"},{default:t(()=>l[6]||(l[6]=[U("添加")])),_:1,__:[6]}),e(F,{type:"danger"},{default:t(()=>l[7]||(l[7]=[U("删除")])),_:1,__:[7]})]),_:1})]),_:1},8,["data"])]),_:1}),e(s,null,{default:t(()=>[e(F,{type:"primary",onClick:c},{default:t(()=>l[8]||(l[8]=[U("保存")])),_:1,__:[8]}),e(F,{onClick:i},{default:t(()=>l[9]||(l[9]=[U("取消")])),_:1,__:[9]})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ve=Y({__name:"skuForm",emits:["changeSence"],setup(v,{emit:p}){let r=p;const b=()=>{r("changeSence",0)};return(m,k)=>{const L=a("el-button"),w=a("el-card");return _(),A(w,null,{default:t(()=>[e(L,{onClick:b},{default:t(()=>k[0]||(k[0]=[U("切换sku")])),_:1,__:[0]})]),_:1})}}}),Ue=Y({__name:"index",setup(v){let p=u(0),r=u(),b=u(),m=u(),k=u(),L=u(),w=u({id:0,spuName:"",description:"",category3Id:0,tmId:0}),g=u(1),h=u(10);te(m,()=>{m.value&&T()});const q=i=>{p.value=i},I=i=>{p.value=1,w.value=i},S=()=>{p.value=2},T=async()=>{let i=await ye(g.value,h.value,m.value);i.code==200&&(L.value=i.data,k.value=i.data.records)},H=i=>{h.value=i},G=i=>{g.value=i},J=i=>{console.log("c3Id",i)};return(i,c)=>{const C=a("el-card"),z=a("plus"),x=a("el-icon"),f=a("el-button"),y=a("el-table-column"),K=a("edit"),O=a("InfoFilled"),n=a("delete"),l=a("el-table"),V=a("el-pagination");return _(),N(P,null,[e(C,{class:"box-card-up"},{default:t(()=>[e(ve,{c1Id:o(r),"onUpdate:c1Id":c[0]||(c[0]=s=>D(r)?r.value=s:r=s),c2Id:o(b),"onUpdate:c2Id":c[1]||(c[1]=s=>D(b)?b.value=s:b=s),c3Id:o(m),"onUpdate:c3Id":c[2]||(c[2]=s=>D(m)?m.value=s:m=s),onCategoryChange:J},null,8,["c1Id","c2Id","c3Id"])]),_:1}),W($("div",null,[e(C,{class:"box-card_down"},{default:t(()=>{var s;return[e(f,{class:"button",type:"primary",disabled:o(m)===void 0,onClick:c[3]||(c[3]=B=>I(o(w)))},{default:t(()=>[e(x,{style:{"vertical-align":"middle"}},{default:t(()=>[e(z)]),_:1}),c[6]||(c[6]=$("span",null,"添加SPU",-1))]),_:1,__:[6]},8,["disabled"]),e(l,{border:"",style:{margin:"10px 0",width:"100%"},data:o(k)},{default:t(()=>[e(y,{type:"index",label:"序号",width:"80"}),e(y,{prop:"spuName",label:"SPU名称",width:"230"}),e(y,{"show-overflow-tooltip":!0,prop:"description",label:"SPU描述",width:"350"}),e(y,{label:"操作"},{default:t(({row:B,$index:Q})=>[e(f,{type:"primary",onClick:Z=>I(B)},{default:t(()=>[e(x,{style:{"vertical-align":"middle"}},{default:t(()=>[e(z)]),_:1})]),_:2},1032,["onClick"]),e(f,{type:"warning",onClick:S},{default:t(()=>[e(x,{style:{"vertical-align":"middle"}},{default:t(()=>[e(K)]),_:1})]),_:1}),e(f,{type:"info",onClick:c[4]||(c[4]=()=>{})},{default:t(()=>[e(x,{style:{"vertical-align":"middle"}},{default:t(()=>[e(O)]),_:1})]),_:1}),e(f,{type:"danger",onClick:c[5]||(c[5]=()=>{})},{default:t(()=>[e(x,{style:{"vertical-align":"middle"}},{default:t(()=>[e(n)]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),e(V,{onSizeChange:H,onCurrentChange:G,"current-page":o(g),"page-sizes":[5,10,15,20],"page-size":o(h),layout:" prev, pager, next, jumper , -> ,total, sizes,",total:(s=o(L))==null?void 0:s.total},null,8,["current-page","page-size","total"])]}),_:1})],512),[[X,o(p)==0]]),$("div",null,[W(e(xe,{onChangeSence:q,row:o(w),c3Id:o(m)},null,8,["row","c3Id"]),[[X,o(p)===1]])]),$("div",null,[W(e(Ve,{onChangeSence:q},null,512),[[X,o(p)===2]])])],64)}}}),Ne=fe(Ue,[["__scopeId","data-v-dd0e04f5"]]);export{Ne as default};
