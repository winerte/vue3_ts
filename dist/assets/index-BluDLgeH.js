import{m as y,d as oe,n as s,x as ne,q as ue,c as w,g as l,w as t,r as n,F as V,a as _,b as I,k as f,j as z,s as R,o as c,f as $,t as re,_ as de}from"./index-B65CSbob.js";const se=()=>y.get("admin/product/getCategory1"),ie=i=>y.get(`admin/product/getCategory2/${i}`),pe=i=>y.get(`admin/product/getCategory3/${i}`),ce=(i,g,b)=>y.get(`admin/product/attrInfoList/${i}/${g}/${b}`),me=i=>y.delete(`admin/product/deleteAttr/${i}`),ve=i=>y.post("admin/product/saveAttrInfo",i),_e={class:"button-group"},fe={class:"dialog-footer"},ye=oe({__name:"index",setup(i){const g=s([]),b=s([]),x=s([]),q=s(),k=s(),r=s(),A=s([]),u=s();let L=s(!0),d=s(!1),U=s("");const S=()=>{L.value=!1},G=()=>{L.value=!0,u.value.attrName=""},H=async()=>{try{let o=await se();g.value=Array.isArray(o)?o:o.data||[]}catch(o){console.error("获取一级分类失败:",o),g.value=[]}},J=async o=>{try{let e=await ie(o);b.value=Array.isArray(e)?e:e.data||[],k.value=0,r.value=0,x.value=[]}catch(e){console.error("获取二级分类失败:",e),b.value=[]}},K=async o=>{try{let e=await pe(o);x.value=Array.isArray(e)?e:e.data||[],r.value=0}catch(e){console.error("获取三级分类失败:",e),x.value=[]}},P=o=>{J(o)},Q=o=>{K(o)};ne(r,()=>{if(r.value===0){A.value=[];return}N()});const N=async()=>{let o=await ce(q.value,k.value,r.value);o.code===200?A.value=o.data:A.value=[]};ue(()=>{H()});const W=async o=>{(await me(o)).code===200?(N(),alert("删除成功")):alert("删除失败")},X=o=>{U.value="修改属性",d.value=!0,u.value=o,L.value=!1},Y=async()=>{var e;let o=await ve(u.value);(e=u.value)!=null&&e.id?o.code===200&&(N(),d.value=!1,alert("修改成功")):o.code===200&&(N(),d.value=!1,alert("添加成功"))},Z=()=>{console.log(r.value),!(r.value===0||r.value===void 0)&&(d.value=!0,U.value="添加属性",u.value={attrName:"",categoryId:r.value,categoryLevel:3,attrValueList:[]})},ee=()=>{u.value.attrValueList.push({valueName:"",attrId:0})},le=o=>{u.value.attrValueList=u.value.attrValueList.filter(e=>e.id!==o.id)};return(o,e)=>{const h=n("el-option"),B=n("el-select"),C=n("el-form-item"),D=n("el-form"),F=n("el-card"),T=n("plus"),j=n("el-icon"),m=n("el-button"),v=n("el-table-column"),te=n("el-tag"),E=n("el-table"),M=n("el-input"),ae=n("el-dialog");return c(),w(V,null,[l(F,{class:"box-card_up"},{default:t(()=>[_("div",null,[l(D,{inline:!0,size:"medium"},{default:t(()=>[l(C,{label:"一级分类","label-width":"80px"},{default:t(()=>[l(B,{modelValue:q.value,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value=a),placeholder:"请选择",onChange:P,style:{width:"200px"}},{default:t(()=>[(c(!0),w(V,null,I(g.value,a=>(c(),$(h,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(C,{label:"二级分类"},{default:t(()=>[l(B,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),placeholder:"请选择",onChange:Q,style:{width:"200px"}},{default:t(()=>[(c(!0),w(V,null,I(b.value,a=>(c(),$(h,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(C,{label:"三级分类"},{default:t(()=>[l(B,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),placeholder:"请选择",onChange:e[3]||(e[3]=()=>{}),style:{width:"200px"}},{default:t(()=>[(c(!0),w(V,null,I(x.value,a=>(c(),$(h,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1}),l(F,{class:"box-card_down"},{header:t(()=>[l(m,{class:"button",type:"primary",onClick:Z},{default:t(()=>[l(j,{style:{"vertical-align":"middle"}},{default:t(()=>[l(T)]),_:1}),e[7]||(e[7]=_("span",null,"添加属性",-1))]),_:1,__:[7]})]),default:t(()=>[l(E,{data:A.value,border:"",style:{width:"100%"}},{default:t(()=>[l(v,{label:"序号",type:"index",width:"80px"}),l(v,{label:"属性名称",width:"200px",prop:"attrName"}),l(v,{label:"属性值名称"},{default:t(a=>[(c(!0),w(V,null,I(a.row.attrValueList,p=>(c(),$(te,{style:{margin:"5px"},key:p.id},{default:t(()=>[f(re(p.valueName),1)]),_:2},1024))),128))]),_:1}),l(v,{label:"操作",width:"300px"},{default:t(a=>[l(m,{type:"primary",size:"mini",onClick:p=>X(a.row)},{default:t(()=>e[8]||(e[8]=[f("修改")])),_:2,__:[8]},1032,["onClick"]),l(m,{type:"danger",size:"mini",onClick:p=>W(a.row.id)},{default:t(()=>e[9]||(e[9]=[f("删除")])),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(ae,{title:z(U),modelValue:z(d),"onUpdate:modelValue":e[6]||(e[6]=a=>R(d)?d.value=a:d=a)},{footer:t(()=>[_("span",fe,[l(m,{onClick:e[5]||(e[5]=a=>R(d)?d.value=!1:d=!1)},{default:t(()=>e[13]||(e[13]=[f("取 消")])),_:1,__:[13]}),l(m,{type:"primary",onClick:Y},{default:t(()=>e[14]||(e[14]=[f("确 定")])),_:1,__:[14]})])]),default:t(()=>[l(D,{model:u.value},{default:t(()=>[l(C,{label:"属性名称"},{default:t(()=>[l(M,{modelValue:u.value.attrName,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value.attrName=a),onInput:S},null,8,["modelValue"])]),_:1}),l(C,{class:"attr-value-section"},{default:t(()=>{var a;return[_("div",_e,[l(m,{type:"primary",disabled:z(L),onClick:ee},{default:t(()=>[l(j,{style:{"vertical-align":"middle"}},{default:t(()=>[l(T)]),_:1}),e[10]||(e[10]=_("span",null,"添加属性值",-1))]),_:1,__:[10]},8,["disabled"]),l(m,{type:"normal",onClick:G,style:{"margin-left":"10px"}},{default:t(()=>e[11]||(e[11]=[_("span",null,"取消",-1)])),_:1,__:[11]})]),l(E,{border:"",data:(a=u.value)==null?void 0:a.attrValueList,"highlight-current-row":"",style:{width:"100%","margin-top":"20px"}},{default:t(()=>[l(v,{type:"index",width:"50"}),l(v,{property:"valueName",label:"属性值",width:"120"},{default:t(p=>[l(M,{modelValue:p.row.valueName,"onUpdate:modelValue":O=>p.row.valueName=O},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(v,{label:"操作"},{default:t(p=>[l(m,{type:"danger",size:"mini",onClick:O=>le(p.row)},{default:t(()=>e[12]||(e[12]=[f("删除")])),_:2,__:[12]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]}),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])]),_:1})],64)}}}),be=de(ye,[["__scopeId","data-v-8585375f"]]);export{be as default};
