import{m as ee,d as se,q as ce,y as re,n as m,i as fe,x as ge,p as ne,f as E,w as l,r as a,g as e,j as d,s as M,c as T,b as Q,F as J,e as pe,a as H,k as _,H as de,o as S,t as ue,_ as ie,l as ae,v as oe}from"./index-Du_Ei7i5.js";import{_ as be}from"./category.vue_vue_type_script_setup_true_lang-Js-3KG7W.js";import{d as ve}from"./index-DVsZ8Csg.js";const Ve=(L,k,g)=>ee.get(`/admin/product/${L}/${k}?category3Id=${g}`),ye=()=>ee.get("/admin/product/baseSaleAttrList"),we=L=>ee.get(`/admin/product/spuImageList/${L}`),Ie=L=>ee.get(`/admin/product/spuSaleAttrList/${L}`),Se=["src"],Ue=["src"],ke=se({__name:"spuForm",props:{row:{},c3Id:{}},emits:["changeSence"],setup(L,{emit:k}){const g=L;ce(()=>{c(),G()}),re(()=>g.row,()=>{g.row&&(u(g.row.id),K(g.row.id),f.value=g.row.tmId)});let z=m([]);const c=async()=>{let s=await ve();s.code===200&&(z.value=s.data)},u=async s=>{let o=await we(s);o.code==200&&(P.value=o.data,V("update:spuImageList",o.data))},K=async s=>{let o=await Ie(s);if(o.code==200){v.value=o.data;const N=new Set(o.data.map(A=>A.baseSaleAttrId));I.value=h.value.filter(A=>!N.has(A.id)),I.value.length>0&&(t.value=I.value[0].id)}};let v=m([]),I=m([]),h=m([]);const G=async()=>{let s=await ye();s.code==200&&(h.value=s.data)};let f=m(),t=m();const $=fe(),D=ge(()=>({token:$.token||""})),b=m("undefined/admin/product/fileUpload");let V=k;const U=()=>{V("changeSence",0)},C=()=>{console.log("保存成功"),de.success({message:"恭喜你，这是一条成功消息",type:"success"})};let w=m(!1),r=m("");const p=s=>{w.value=!0,r=s.url};let P=m([]),F=ne({imgName:"",imgUrl:"",spuId:g.c3Id});const B=(s,o,N)=>{console.log(g.c3Id),s.code===200&&(F.imgUrl=o.response.data,F.imgName=o.name,F.spuId=g.c3Id,P.value.push(F))},n=()=>{var s,o;v.value.push({baseSaleAttrId:t.value,saleAttrName:(s=I.value.find(N=>N.id===t.value))==null?void 0:s.name,spuId:(o=g.row)==null?void 0:o.id,spuSaleAttrValueList:[]}),I.value.splice(I.value.findIndex(N=>N.id===t.value),1)};return(s,o)=>{const N=a("el-input"),A=a("el-form-item"),W=a("el-option"),X=a("el-select"),j=a("plus"),O=a("el-icon"),le=a("el-upload"),te=a("el-dialog"),q=a("el-button"),y=a("el-table-column"),x=a("el-tag"),Y=a("el-table"),Z=a("el-form"),me=a("el-card");return S(),E(me,null,{default:l(()=>[e(Z,{ref:"form",model:s.row,"label-width":"120px"},{default:l(()=>[e(A,{label:"spu名称"},{default:l(()=>[e(N,{modelValue:s.row.spuName,"onUpdate:modelValue":o[0]||(o[0]=i=>s.row.spuName=i)},null,8,["modelValue"])]),_:1}),e(A,{label:"spu品牌"},{default:l(()=>[e(X,{modelValue:d(f),"onUpdate:modelValue":o[1]||(o[1]=i=>M(f)?f.value=i:f=i),placeholder:"请选择",style:{width:"200px"}},{default:l(()=>[(S(!0),T(J,null,Q(d(z),(i,R)=>(S(),E(W,{key:R,label:i.tmName,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(A,{label:"spu描述"},{default:l(()=>[e(N,{type:"textarea",autosize:"",placeholder:"请输入内容",modelValue:s.row.description,"onUpdate:modelValue":o[2]||(o[2]=i=>s.row.description=i)},null,8,["modelValue"])]),_:1}),e(A,{label:"spu照片"},{default:l(()=>[d(P).length<0?(S(),E(le,{key:0,action:b.value,headers:D.value,"list-type":"picture-card","on-preview":p,"on-success":B},{default:l(()=>[e(O,null,{default:l(()=>[e(j)]),_:1})]),_:1},8,["action","headers"])):pe("",!0),e(te,{modelValue:d(w),"onUpdate:modelValue":o[3]||(o[3]=i=>M(w)?w.value=i:w=i)},{default:l(()=>[H("img",{width:"100%",src:d(r),alt:""},null,8,Se)]),_:1},8,["modelValue"]),d(P).length>0?(S(!0),T(J,{key:1},Q(d(P),(i,R)=>(S(),T("img",{style:{margin:"10px"},src:i.imgUrl,alt:""},null,8,Ue))),256)):pe("",!0)]),_:1}),e(A,{label:"spu销售属性"},{default:l(()=>[e(X,{modelValue:d(t),"onUpdate:modelValue":o[4]||(o[4]=i=>M(t)?t.value=i:t=i),placeholder:"请选择",style:{width:"200px"}},{default:l(()=>[(S(!0),T(J,null,Q(d(I),i=>(S(),E(W,{label:i.name,value:i.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),e(q,{type:"primary",icon:"plus",disabled:!(d(I).length>0),style:{"margin-left":"10px"},onClick:n},{default:l(()=>o[5]||(o[5]=[_("添加")])),_:1,__:[5]},8,["disabled"]),e(Y,{data:d(v),border:"",style:{margin:"10px 0"},width:"100%"},{default:l(()=>[e(y,{type:"index",label:"序号",width:"80"}),e(y,{label:"属性名",prop:"saleAttrName"}),e(y,{label:"属性值"},{default:l(i=>[(S(!0),T(J,null,Q(i.row.spuSaleAttrValueList,(R,_e)=>(S(),E(x,{closable:"",key:_e,style:{"margin-right":"8px"}},{default:l(()=>[_(ue(R.saleAttrValueName),1)]),_:2},1024))),128)),e(q,{class:"button-new-tag",size:"small",onClick:s.showInput},{default:l(()=>o[6]||(o[6]=[_("+ New Tag")])),_:1,__:[6]},8,["onClick"])]),_:1}),e(y,{label:"操作"},{default:l(()=>[e(q,{type:"primary"},{default:l(()=>o[7]||(o[7]=[_("添加")])),_:1,__:[7]}),e(q,{type:"danger"},{default:l(()=>o[8]||(o[8]=[_("删除")])),_:1,__:[8]})]),_:1})]),_:1},8,["data"])]),_:1}),e(A,null,{default:l(()=>[e(q,{type:"primary",onClick:C},{default:l(()=>o[9]||(o[9]=[_("保存")])),_:1,__:[9]}),e(q,{onClick:U},{default:l(()=>o[10]||(o[10]=[_("取消")])),_:1,__:[10]})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ae=["src"],Ce=se({__name:"skuForm",props:{row:{},c3Id:{}},emits:["changeSence"],setup(L,{emit:k}){const g=L;let z=k;const c=ne({spuName:"",description:""}),u=ne({skuName:"",price:0,weight:0,skuDesc:"",platformAttr1:"",platformAttr2:"",platformAttr3:"",platformAttr4:"",platformAttr5:"",platformAttr6:"",saleAttr1:"",isDefault:0}),K=m([]);re(()=>g.row,f=>{f&&(c.spuName=f.spuName||"",c.description=f.description||"",f.id&&v(f.id))},{immediate:!0});const v=async f=>{console.log("获取SPU图片列表，spuId:",f),K.value=[{id:1,imgUrl:"https://picsum.photos/200/200?random=1",imgName:"1.png"},{id:2,imgUrl:"https://picsum.photos/200/200?random=2",imgName:"2.png"},{id:3,imgUrl:"https://picsum.photos/200/200?random=3",imgName:"3.png"}]},I=f=>{K.value.forEach(t=>{t.isDefault=0}),f.isDefault=1,de.success("已设置为默认图片")},h=()=>{console.log("保存SKU数据:",u),de.success("SKU保存成功")},G=()=>{z("changeSence",0)};return(f,t)=>{const $=a("el-divider"),D=a("el-input"),b=a("el-form-item"),V=a("el-col"),U=a("el-row"),C=a("el-option"),w=a("el-select"),r=a("el-table-column"),p=a("el-button"),P=a("el-table"),F=a("el-form"),B=a("el-card");return S(),E(B,null,{default:l(()=>[e(F,{ref:"form",model:u,"label-width":"120px"},{default:l(()=>[e($,{"content-position":"left"},{default:l(()=>t[13]||(t[13]=[_("SPU基本信息")])),_:1,__:[13]}),e(U,null,{default:l(()=>[e(V,{span:12},{default:l(()=>[e(b,{label:"SPU名称"},{default:l(()=>[e(D,{modelValue:c.spuName,"onUpdate:modelValue":t[0]||(t[0]=n=>c.spuName=n),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:12},{default:l(()=>[e(b,{label:"SPU描述"},{default:l(()=>[e(D,{modelValue:c.description,"onUpdate:modelValue":t[1]||(t[1]=n=>c.description=n),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e($,{"content-position":"left"},{default:l(()=>t[14]||(t[14]=[_("SKU信息")])),_:1,__:[14]}),e(b,{label:"SKU名称"},{default:l(()=>[e(D,{modelValue:u.skuName,"onUpdate:modelValue":t[2]||(t[2]=n=>u.skuName=n),placeholder:"请输入SKU名称"},null,8,["modelValue"])]),_:1}),e(U,null,{default:l(()=>[e(V,{span:8},{default:l(()=>[e(b,{label:"价格(元)"},{default:l(()=>[e(D,{modelValue:u.price,"onUpdate:modelValue":t[3]||(t[3]=n=>u.price=n),type:"number",placeholder:"请输入价格"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(b,{label:"重量(克)"},{default:l(()=>[e(D,{modelValue:u.weight,"onUpdate:modelValue":t[4]||(t[4]=n=>u.weight=n),type:"number",placeholder:"请输入重量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,{label:"SKU描述"},{default:l(()=>[e(D,{modelValue:u.skuDesc,"onUpdate:modelValue":t[5]||(t[5]=n=>u.skuDesc=n),type:"textarea",autosize:"",placeholder:"请输入SKU描述"},null,8,["modelValue"])]),_:1}),e($,{"content-position":"left"},{default:l(()=>t[15]||(t[15]=[_("平台属性")])),_:1,__:[15]}),e(U,null,{default:l(()=>[e(V,{span:8},{default:l(()=>[e(b,{label:"手机一级"},{default:l(()=>[e(w,{modelValue:u.platformAttr1,"onUpdate:modelValue":t[6]||(t[6]=n=>u.platformAttr1=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(b,{label:"电池容量"},{default:l(()=>[e(w,{modelValue:u.platformAttr2,"onUpdate:modelValue":t[7]||(t[7]=n=>u.platformAttr2=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(b,{label:"运行内存"},{default:l(()=>[e(w,{modelValue:u.platformAttr3,"onUpdate:modelValue":t[8]||(t[8]=n=>u.platformAttr3=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,null,{default:l(()=>[e(V,{span:8},{default:l(()=>[e(b,{label:"机身内存"},{default:l(()=>[e(w,{modelValue:u.platformAttr4,"onUpdate:modelValue":t[9]||(t[9]=n=>u.platformAttr4=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(b,{label:"CPU型号"},{default:l(()=>[e(w,{modelValue:u.platformAttr5,"onUpdate:modelValue":t[10]||(t[10]=n=>u.platformAttr5=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(b,{label:"屏幕尺寸"},{default:l(()=>[e(w,{modelValue:u.platformAttr6,"onUpdate:modelValue":t[11]||(t[11]=n=>u.platformAttr6=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e($,{"content-position":"left"},{default:l(()=>t[16]||(t[16]=[_("销售属性")])),_:1,__:[16]}),e(U,null,{default:l(()=>[e(V,{span:8},{default:l(()=>[e(b,{label:"颜色"},{default:l(()=>[e(w,{modelValue:u.saleAttr1,"onUpdate:modelValue":t[12]||(t[12]=n=>u.saleAttr1=n),placeholder:"请选择"},{default:l(()=>[e(C,{label:"请选择",value:""})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e($,{"content-position":"left"},{default:l(()=>t[17]||(t[17]=[_("图片管理")])),_:1,__:[17]}),e(P,{data:K.value,border:"",style:{margin:"10px 0",width:"100%"}},{default:l(()=>[e(r,{type:"selection",width:"55"}),e(r,{label:"图片",width:"120"},{default:l(n=>[H("img",{src:n.row.imgUrl,style:{width:"80px",height:"80px","object-fit":"cover"}},null,8,Ae)]),_:1}),e(r,{prop:"imgName",label:"名称"}),e(r,{label:"操作",width:"120"},{default:l(n=>[e(p,{type:"primary",size:"small",onClick:s=>I(n.row)},{default:l(()=>t[18]||(t[18]=[_(" 设置默认 ")])),_:2,__:[18]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(b,null,{default:l(()=>[e(p,{type:"primary",onClick:h},{default:l(()=>t[19]||(t[19]=[_("保存SKU")])),_:1,__:[19]}),e(p,{onClick:G},{default:l(()=>t[20]||(t[20]=[_("取消")])),_:1,__:[20]})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ne=ie(Ce,[["__scopeId","data-v-3272e7f7"]]),xe=["src"],Le=se({__name:"index",setup(L){let k=m(0),g=m(),z=m(),c=m(),u=m(),K=m(),v=m({id:0,spuName:"",description:"",category3Id:0,tmId:0}),I=m(1),h=m(10);re(c,()=>{c.value&&$()});const G=r=>{k.value=r},f=r=>{k.value=1,v.value=r},t=r=>{k.value=2,v.value=r},$=async()=>{let r=await Ve(I.value,h.value,c.value);r.code==200&&(K.value=r.data,u.value=r.data.records)},D=r=>{h.value=r},b=r=>{I.value=r},V=r=>{console.log("c3Id",r)};let U=m(!1);const C=r=>{v.value.spuImageList=r},w=r=>{v.value=r,U.value=!0};return(r,p)=>{const P=a("el-card"),F=a("plus"),B=a("el-icon"),n=a("el-button"),s=a("el-table-column"),o=a("edit"),N=a("InfoFilled"),A=a("delete"),W=a("el-table"),X=a("el-pagination"),j=a("el-col"),O=a("el-row"),le=a("el-carousel-item"),te=a("el-carousel"),q=a("el-drawer");return S(),T(J,null,[e(P,{class:"box-card-up"},{default:l(()=>[e(be,{c1Id:d(g),"onUpdate:c1Id":p[0]||(p[0]=y=>M(g)?g.value=y:g=y),c2Id:d(z),"onUpdate:c2Id":p[1]||(p[1]=y=>M(z)?z.value=y:z=y),c3Id:d(c),"onUpdate:c3Id":p[2]||(p[2]=y=>M(c)?c.value=y:c=y),onCategoryChange:V},null,8,["c1Id","c2Id","c3Id"])]),_:1}),ae(H("div",null,[e(P,{class:"box-card_down"},{default:l(()=>{var y;return[e(n,{class:"button",type:"primary",disabled:d(c)===void 0,onClick:p[3]||(p[3]=x=>f(d(v)))},{default:l(()=>[e(B,{style:{"vertical-align":"middle"}},{default:l(()=>[e(F)]),_:1}),p[6]||(p[6]=H("span",null,"添加SPU",-1))]),_:1,__:[6]},8,["disabled"]),e(W,{border:"",style:{margin:"10px 0",width:"100%"},data:d(u)},{default:l(()=>[e(s,{type:"index",label:"序号",width:"80"}),e(s,{prop:"spuName",label:"SPU名称",width:"230"}),e(s,{"show-overflow-tooltip":!0,prop:"description",label:"SPU描述",width:"350"}),e(s,{label:"操作"},{default:l(({row:x,$index:Y})=>[e(n,{type:"primary",onClick:Z=>f(x)},{default:l(()=>[e(B,{style:{"vertical-align":"middle"}},{default:l(()=>[e(F)]),_:1})]),_:2},1032,["onClick"]),e(n,{type:"warning",onClick:Z=>t(x)},{default:l(()=>[e(B,{style:{"vertical-align":"middle"}},{default:l(()=>[e(o)]),_:1})]),_:2},1032,["onClick"]),e(n,{type:"info",onClick:Z=>w(x)},{default:l(()=>[e(B,{style:{"vertical-align":"middle"}},{default:l(()=>[e(N)]),_:1})]),_:2},1032,["onClick"]),e(n,{type:"danger",onClick:p[4]||(p[4]=()=>{})},{default:l(()=>[e(B,{style:{"vertical-align":"middle"}},{default:l(()=>[e(A)]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),e(X,{onSizeChange:D,onCurrentChange:b,"current-page":d(I),"page-sizes":[5,10,15,20],"page-size":d(h),layout:" prev, pager, next, jumper , -> ,total, sizes,",total:(y=d(K))==null?void 0:y.total},null,8,["current-page","page-size","total"]),e(q,{title:"spu信息",modelValue:d(U),"onUpdate:modelValue":p[5]||(p[5]=x=>M(U)?U.value=x:U=x),"destroy-on-close":""},{default:l(()=>[e(O,null,{default:l(()=>[e(j,{span:8},{default:l(()=>p[7]||(p[7]=[_(" spu名称 ")])),_:1,__:[7]}),e(j,{span:16},{default:l(()=>[_(ue(d(v).spuName),1)]),_:1})]),_:1}),e(O,null,{default:l(()=>[e(j,{span:8},{default:l(()=>p[8]||(p[8]=[_(" spu描述 ")])),_:1,__:[8]}),e(j,{span:16},{default:l(()=>[_(ue(d(v).description),1)]),_:1})]),_:1}),e(O,null,{default:l(()=>[e(j,{span:8},{default:l(()=>p[9]||(p[9]=[_(" spu图片 ")])),_:1,__:[9]}),e(j,{span:16},{default:l(()=>[e(te,{interval:4e3,type:"card",height:"200px"},{default:l(()=>[(S(!0),T(J,null,Q(d(v).spuImageList||[],(x,Y)=>(S(),E(le,{key:Y},{default:l(()=>[H("img",{src:x.imgUrl,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,xe)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1})],512),[[oe,d(k)==0]]),H("div",null,[ae(e(ke,{onChangeSence:G,row:d(v),c3Id:d(c),"onUpdate:spuImageList":C},null,8,["row","c3Id"]),[[oe,d(k)===1]])]),H("div",null,[ae(e(Ne,{onChangeSence:G,row:d(v),c3Id:d(c)},null,8,["row","c3Id"]),[[oe,d(k)===2]])])],64)}}}),$e=ie(Le,[["__scopeId","data-v-01d40d9d"]]);export{$e as default};
