import{y as j,d as W,q as de,x as te,m as u,i as ue,p as re,n as ie,f as B,w as t,r as a,g as e,j as o,s as N,c as D,b as K,F as R,e as ee,a as F,k as V,E as ce,o as b,l as O,v as Q,_ as pe}from"./index-hvf4pCZU.js";import{_ as me}from"./category.vue_vue_type_script_setup_true_lang-BOA3OFtG.js";import{d as _e}from"./index--m9s7QCL.js";const ge=(v,p,r)=>j.get(`/admin/product/${v}/${p}?category3Id=${r}`),fe=()=>j.get("/admin/product/baseSaleAttrList"),be=v=>j.get(`/admin/product/spuImageList/${v}`),ve=v=>j.get(`/admin/product/spuSaleAttrList/${v}`),ye=["src"],we=["src"],Ie=W({__name:"spuForm",props:{row:{},c3Id:{}},emits:["changeSence"],setup(v,{emit:p}){const r=v;de(()=>{m(),A()}),te(()=>r.row,()=>{r.row&&(S(r.row.id),U(r.row.id),I.value=r.row.tmId)});let y=u([]);const m=async()=>{let n=await _e();n.code===200&&(y.value=n.data)},S=async n=>{let l=await be(n);l.code==200&&(g.value=l.data)},U=async n=>{let l=await ve(n);if(l.code==200){const x=new Set(l.data.map(_=>_.baseSaleAttrId));w.value=C.value.filter(_=>!x.has(_.id)),console.log("不在现有数据中的属性列表：",w.value)}};let w=u([]),C=u([]);const A=async()=>{let n=await fe();n.code==200&&(C.value=n.data)};let I=u(),k=u();const M=ue(),T=re(()=>({token:M.token||""})),H=u("undefined/admin/product/fileUpload");let G=p;const J=()=>{G("changeSence",0)},i=()=>{console.log("保存成功"),ce.success({message:"恭喜你，这是一条成功消息",type:"success"})};let s=u(!1),h=u("");const P=n=>{s.value=!0,h=n.url};let g=u([]),f=ie({imgName:"",imgUrl:"",spuId:r.c3Id});const L=(n,l,x)=>{console.log(r.c3Id),n.code===200&&(f.imgUrl=l.response.data,f.imgName=l.name,f.spuId=r.c3Id,g.value.push(f))};return(n,l)=>{const x=a("el-input"),_=a("el-form-item"),$=a("el-option"),c=a("el-select"),q=a("plus"),X=a("el-icon"),Y=a("el-upload"),le=a("el-dialog"),z=a("el-button"),E=a("el-table-column"),ae=a("el-tag"),oe=a("el-table"),ne=a("el-form"),se=a("el-card");return b(),B(se,null,{default:t(()=>[e(ne,{ref:"form",model:n.row,"label-width":"120px"},{default:t(()=>[e(_,{label:"spu名称"},{default:t(()=>[e(x,{modelValue:n.row.spuName,"onUpdate:modelValue":l[0]||(l[0]=d=>n.row.spuName=d)},null,8,["modelValue"])]),_:1}),e(_,{label:"spu品牌"},{default:t(()=>[e(c,{modelValue:o(I),"onUpdate:modelValue":l[1]||(l[1]=d=>N(I)?I.value=d:I=d),placeholder:"请选择",style:{width:"200px"}},{default:t(()=>[(b(!0),D(R,null,K(o(y),(d,Z)=>(b(),B($,{key:Z,label:d.tmName,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"spu描述"},{default:t(()=>[e(x,{type:"textarea",autosize:"",placeholder:"请输入内容",modelValue:n.row.description,"onUpdate:modelValue":l[2]||(l[2]=d=>n.row.description=d)},null,8,["modelValue"])]),_:1}),e(_,{label:"spu照片"},{default:t(()=>[o(g).length<0?(b(),B(Y,{key:0,action:H.value,headers:T.value,"list-type":"picture-card","on-preview":P,"on-success":L},{default:t(()=>[e(X,null,{default:t(()=>[e(q)]),_:1})]),_:1},8,["action","headers"])):ee("",!0),e(le,{modelValue:o(s),"onUpdate:modelValue":l[3]||(l[3]=d=>N(s)?s.value=d:s=d)},{default:t(()=>[F("img",{width:"100%",src:o(h),alt:""},null,8,ye)]),_:1},8,["modelValue"]),o(g).length>0?(b(!0),D(R,{key:1},K(o(g),(d,Z)=>(b(),D("img",{style:{margin:"10px"},src:d.imgUrl,alt:""},null,8,we))),256)):ee("",!0)]),_:1}),e(_,{label:"spu销售属性"},{default:t(()=>[e(c,{modelValue:o(k),"onUpdate:modelValue":l[4]||(l[4]=d=>N(k)?k.value=d:k=d),placeholder:"请选择",style:{width:"200px"}},{default:t(()=>[(b(!0),D(R,null,K(o(C).value,d=>(b(),B($,{label:d.name,value:d.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),e(z,{type:"primary",icon:"plus",disabled:"",style:{"margin-left":"10px"}},{default:t(()=>l[5]||(l[5]=[V("添加")])),_:1,__:[5]}),e(oe,{border:"",style:{margin:"10px 0"},width:"100%"},{default:t(()=>[e(E,{type:"index",label:"序号",width:"80"}),e(E,{label:"属性名"}),e(E,{label:"属性值"},{default:t(()=>[e(ae,null,{default:t(()=>l[6]||(l[6]=[V("111")])),_:1,__:[6]})]),_:1}),e(E,{label:"操作"},{default:t(()=>[e(z,{type:"primary"},{default:t(()=>l[7]||(l[7]=[V("添加")])),_:1,__:[7]}),e(z,{type:"danger"},{default:t(()=>l[8]||(l[8]=[V("删除")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(z,{type:"primary",onClick:i},{default:t(()=>l[9]||(l[9]=[V("保存")])),_:1,__:[9]}),e(z,{onClick:J},{default:t(()=>l[10]||(l[10]=[V("取消")])),_:1,__:[10]})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Se=W({__name:"skuForm",emits:["changeSence"],setup(v,{emit:p}){let r=p;const y=()=>{r("changeSence",0)};return(m,S)=>{const U=a("el-button"),w=a("el-card");return b(),B(w,null,{default:t(()=>[e(U,{onClick:y},{default:t(()=>S[0]||(S[0]=[V("切换sku")])),_:1,__:[0]})]),_:1})}}}),Ce=W({__name:"index",setup(v){let p=u(0),r=u(),y=u(),m=u(),S=u(),U=u(),w=u({id:0,spuName:"",description:"",category3Id:0,tmId:0}),C=u(1),A=u(10);te(m,()=>{m.value&&T()});const I=i=>{p.value=i},k=i=>{p.value=1,w.value=i},M=()=>{p.value=2},T=async()=>{let i=await ge(C.value,A.value,m.value);i.code==200&&(U.value=i.data,S.value=i.data.records)},H=i=>{A.value=i},G=i=>{C.value=i},J=i=>{console.log("c3Id",i)};return(i,s)=>{const h=a("el-card"),P=a("plus"),g=a("el-icon"),f=a("el-button"),L=a("el-table-column"),n=a("edit"),l=a("InfoFilled"),x=a("delete"),_=a("el-table"),$=a("el-pagination");return b(),D(R,null,[e(h,{class:"box-card-up"},{default:t(()=>[e(me,{c1Id:o(r),"onUpdate:c1Id":s[0]||(s[0]=c=>N(r)?r.value=c:r=c),c2Id:o(y),"onUpdate:c2Id":s[1]||(s[1]=c=>N(y)?y.value=c:y=c),c3Id:o(m),"onUpdate:c3Id":s[2]||(s[2]=c=>N(m)?m.value=c:m=c),onCategoryChange:J},null,8,["c1Id","c2Id","c3Id"])]),_:1}),O(F("div",null,[e(h,{class:"box-card_down"},{default:t(()=>{var c;return[e(f,{class:"button",type:"primary",disabled:o(m)===void 0,onClick:s[3]||(s[3]=q=>k(o(w)))},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(P)]),_:1}),s[6]||(s[6]=F("span",null,"添加SPU",-1))]),_:1,__:[6]},8,["disabled"]),e(_,{border:"",style:{margin:"10px 0",width:"100%"},data:o(S)},{default:t(()=>[e(L,{type:"index",label:"序号",width:"80"}),e(L,{prop:"spuName",label:"SPU名称",width:"230"}),e(L,{"show-overflow-tooltip":!0,prop:"description",label:"SPU描述",width:"350"}),e(L,{prop:"edit",label:"操作"},{default:t(({row:q,$index:X})=>[e(f,{type:"primary",onClick:Y=>k(q)},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(P)]),_:1})]),_:2},1032,["onClick"]),e(f,{type:"warning",onClick:M},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(n)]),_:1})]),_:1}),e(f,{type:"info",onClick:s[4]||(s[4]=()=>{})},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(l)]),_:1})]),_:1}),e(f,{type:"danger",onClick:s[5]||(s[5]=()=>{})},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(x)]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),e($,{onSizeChange:H,onCurrentChange:G,"current-page":o(C),"page-sizes":[5,10,15,20],"page-size":o(A),layout:" prev, pager, next, jumper , -> ,total, sizes,",total:(c=o(U))==null?void 0:c.total},null,8,["current-page","page-size","total"])]}),_:1})],512),[[Q,o(p)==0]]),F("div",null,[O(e(Ie,{onChangeSence:I,row:o(w),c3Id:o(m)},null,8,["row","c3Id"]),[[Q,o(p)===1]])]),F("div",null,[O(e(Se,{onChangeSence:I},null,512),[[Q,o(p)===2]])])],64)}}}),Ue=pe(Ce,[["__scopeId","data-v-0fcbb151"]]);export{Ue as default};
