import{y as Q,d as se,q as pe,x as de,m as r,i as ce,p as me,n as _e,f as B,w as t,r as a,g as e,j as o,s as F,c as $,b as T,F as E,e as ue,a as j,k as _,E as fe,o as m,t as ne,l as ae,v as oe,_ as ge}from"./index-BtSRkBnv.js";import{_ as ve}from"./category.vue_vue_type_script_setup_true_lang-Bdsttfjt.js";import{d as be}from"./index-C6J1mU3m.js";const we=(S,f,i)=>Q.get(`/admin/product/${S}/${f}?category3Id=${i}`),ye=()=>Q.get("/admin/product/baseSaleAttrList"),Ie=S=>Q.get(`/admin/product/spuImageList/${S}`),Se=S=>Q.get(`/admin/product/spuSaleAttrList/${S}`),Ce=["src"],ke=["src"],Ve=se({__name:"spuForm",props:{row:{},c3Id:{}},emits:["changeSence"],setup(S,{emit:f}){const i=S;pe(()=>{g(),M()}),de(()=>i.row,()=>{i.row&&(U(i.row.id),P(i.row.id),k.value=i.row.tmId)});let C=r([]);const g=async()=>{let n=await be();n.code===200&&(C.value=n.data)},U=async n=>{let l=await Ie(n);l.code==200&&(V.value=l.data,H("update:spuImageList",l.data))},P=async n=>{let l=await Se(n);if(l.code==200){c.value=l.data;const w=new Set(l.data.map(b=>b.baseSaleAttrId));v.value=q.value.filter(b=>!w.has(b.id)),v.value.length>0&&(y.value=v.value[0].id)}};let c=r([]),v=r([]),q=r([]);const M=async()=>{let n=await ye();n.code==200&&(q.value=n.data)};let k=r(),y=r();const W=ce(),X=me(()=>({token:W.token||""})),Y=r("undefined/admin/product/fileUpload");let H=f;const A=()=>{H("changeSence",0)},Z=()=>{console.log("保存成功"),fe.success({message:"恭喜你，这是一条成功消息",type:"success"})};let N=r(!1),d=r("");const s=n=>{N.value=!0,d=n.url};let V=r([]),h=_e({imgName:"",imgUrl:"",spuId:i.c3Id});const z=(n,l,w)=>{console.log(i.c3Id),n.code===200&&(h.imgUrl=l.response.data,h.imgName=l.name,h.spuId=i.c3Id,V.value.push(h))},D=()=>{var n,l;c.value.push({baseSaleAttrId:y.value,saleAttrName:(n=v.value.find(w=>w.id===y.value))==null?void 0:n.name,spuId:(l=i.row)==null?void 0:l.id,spuSaleAttrValueList:[]}),v.value.splice(v.value.findIndex(w=>w.id===y.value),1)};return(n,l)=>{const w=a("el-input"),b=a("el-form-item"),G=a("el-option"),J=a("el-select"),L=a("plus"),R=a("el-icon"),ee=a("el-upload"),te=a("el-dialog"),x=a("el-button"),p=a("el-table-column"),I=a("el-tag"),K=a("el-table"),le=a("el-form"),re=a("el-card");return m(),B(re,null,{default:t(()=>[e(le,{ref:"form",model:n.row,"label-width":"120px"},{default:t(()=>[e(b,{label:"spu名称"},{default:t(()=>[e(w,{modelValue:n.row.spuName,"onUpdate:modelValue":l[0]||(l[0]=u=>n.row.spuName=u)},null,8,["modelValue"])]),_:1}),e(b,{label:"spu品牌"},{default:t(()=>[e(J,{modelValue:o(k),"onUpdate:modelValue":l[1]||(l[1]=u=>F(k)?k.value=u:k=u),placeholder:"请选择",style:{width:"200px"}},{default:t(()=>[(m(!0),$(E,null,T(o(C),(u,O)=>(m(),B(G,{key:O,label:u.tmName,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"spu描述"},{default:t(()=>[e(w,{type:"textarea",autosize:"",placeholder:"请输入内容",modelValue:n.row.description,"onUpdate:modelValue":l[2]||(l[2]=u=>n.row.description=u)},null,8,["modelValue"])]),_:1}),e(b,{label:"spu照片"},{default:t(()=>[o(V).length<0?(m(),B(ee,{key:0,action:Y.value,headers:X.value,"list-type":"picture-card","on-preview":s,"on-success":z},{default:t(()=>[e(R,null,{default:t(()=>[e(L)]),_:1})]),_:1},8,["action","headers"])):ue("",!0),e(te,{modelValue:o(N),"onUpdate:modelValue":l[3]||(l[3]=u=>F(N)?N.value=u:N=u)},{default:t(()=>[j("img",{width:"100%",src:o(d),alt:""},null,8,Ce)]),_:1},8,["modelValue"]),o(V).length>0?(m(!0),$(E,{key:1},T(o(V),(u,O)=>(m(),$("img",{style:{margin:"10px"},src:u.imgUrl,alt:""},null,8,ke))),256)):ue("",!0)]),_:1}),e(b,{label:"spu销售属性"},{default:t(()=>[e(J,{modelValue:o(y),"onUpdate:modelValue":l[4]||(l[4]=u=>F(y)?y.value=u:y=u),placeholder:"请选择",style:{width:"200px"}},{default:t(()=>[(m(!0),$(E,null,T(o(v),u=>(m(),B(G,{label:u.name,value:u.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"]),e(x,{type:"primary",icon:"plus",disabled:!(o(v).length>0),style:{"margin-left":"10px"},onClick:D},{default:t(()=>l[5]||(l[5]=[_("添加")])),_:1,__:[5]},8,["disabled"]),e(K,{data:o(c),border:"",style:{margin:"10px 0"},width:"100%"},{default:t(()=>[e(p,{type:"index",label:"序号",width:"80"}),e(p,{label:"属性名",prop:"saleAttrName"}),e(p,{label:"属性值"},{default:t(u=>[(m(!0),$(E,null,T(u.row.spuSaleAttrValueList,(O,ie)=>(m(),B(I,{closable:"",key:ie,style:{"margin-right":"8px"}},{default:t(()=>[_(ne(O.saleAttrValueName),1)]),_:2},1024))),128)),e(x,{class:"button-new-tag",size:"small",onClick:n.showInput},{default:t(()=>l[6]||(l[6]=[_("+ New Tag")])),_:1,__:[6]},8,["onClick"])]),_:1}),e(p,{label:"操作"},{default:t(()=>[e(x,{type:"primary"},{default:t(()=>l[7]||(l[7]=[_("添加")])),_:1,__:[7]}),e(x,{type:"danger"},{default:t(()=>l[8]||(l[8]=[_("删除")])),_:1,__:[8]})]),_:1})]),_:1},8,["data"])]),_:1}),e(b,null,{default:t(()=>[e(x,{type:"primary",onClick:Z},{default:t(()=>l[9]||(l[9]=[_("保存")])),_:1,__:[9]}),e(x,{onClick:A},{default:t(()=>l[10]||(l[10]=[_("取消")])),_:1,__:[10]})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Le=se({__name:"skuForm",emits:["changeSence"],setup(S,{emit:f}){let i=f;const C=()=>{i("changeSence",0)};return(g,U)=>{const P=a("el-button"),c=a("el-card");return m(),B(c,null,{default:t(()=>[e(P,{onClick:C},{default:t(()=>U[0]||(U[0]=[_("切换sku")])),_:1,__:[0]})]),_:1})}}}),xe=["src"],Ue=se({__name:"index",setup(S){let f=r(0),i=r(),C=r(),g=r(),U=r(),P=r(),c=r({id:0,spuName:"",description:"",category3Id:0,tmId:0}),v=r(1),q=r(10);de(g,()=>{g.value&&W()});const M=d=>{f.value=d},k=d=>{f.value=1,c.value=d},y=()=>{f.value=2},W=async()=>{let d=await we(v.value,q.value,g.value);d.code==200&&(P.value=d.data,U.value=d.data.records)},X=d=>{q.value=d},Y=d=>{v.value=d},H=d=>{console.log("c3Id",d)};let A=r(!1);const Z=d=>{c.value.spuImageList=d},N=d=>{c.value=d,A.value=!0};return(d,s)=>{const V=a("el-card"),h=a("plus"),z=a("el-icon"),D=a("el-button"),n=a("el-table-column"),l=a("edit"),w=a("InfoFilled"),b=a("delete"),G=a("el-table"),J=a("el-pagination"),L=a("el-col"),R=a("el-row"),ee=a("el-carousel-item"),te=a("el-carousel"),x=a("el-drawer");return m(),$(E,null,[e(V,{class:"box-card-up"},{default:t(()=>[e(ve,{c1Id:o(i),"onUpdate:c1Id":s[0]||(s[0]=p=>F(i)?i.value=p:i=p),c2Id:o(C),"onUpdate:c2Id":s[1]||(s[1]=p=>F(C)?C.value=p:C=p),c3Id:o(g),"onUpdate:c3Id":s[2]||(s[2]=p=>F(g)?g.value=p:g=p),onCategoryChange:H},null,8,["c1Id","c2Id","c3Id"])]),_:1}),ae(j("div",null,[e(V,{class:"box-card_down"},{default:t(()=>{var p;return[e(D,{class:"button",type:"primary",disabled:o(g)===void 0,onClick:s[3]||(s[3]=I=>k(o(c)))},{default:t(()=>[e(z,{style:{"vertical-align":"middle"}},{default:t(()=>[e(h)]),_:1}),s[6]||(s[6]=j("span",null,"添加SPU",-1))]),_:1,__:[6]},8,["disabled"]),e(G,{border:"",style:{margin:"10px 0",width:"100%"},data:o(U)},{default:t(()=>[e(n,{type:"index",label:"序号",width:"80"}),e(n,{prop:"spuName",label:"SPU名称",width:"230"}),e(n,{"show-overflow-tooltip":!0,prop:"description",label:"SPU描述",width:"350"}),e(n,{label:"操作"},{default:t(({row:I,$index:K})=>[e(D,{type:"primary",onClick:le=>k(I)},{default:t(()=>[e(z,{style:{"vertical-align":"middle"}},{default:t(()=>[e(h)]),_:1})]),_:2},1032,["onClick"]),e(D,{type:"warning",onClick:y},{default:t(()=>[e(z,{style:{"vertical-align":"middle"}},{default:t(()=>[e(l)]),_:1})]),_:1}),e(D,{type:"info",onClick:le=>N(I)},{default:t(()=>[e(z,{style:{"vertical-align":"middle"}},{default:t(()=>[e(w)]),_:1})]),_:2},1032,["onClick"]),e(D,{type:"danger",onClick:s[4]||(s[4]=()=>{})},{default:t(()=>[e(z,{style:{"vertical-align":"middle"}},{default:t(()=>[e(b)]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),e(J,{onSizeChange:X,onCurrentChange:Y,"current-page":o(v),"page-sizes":[5,10,15,20],"page-size":o(q),layout:" prev, pager, next, jumper , -> ,total, sizes,",total:(p=o(P))==null?void 0:p.total},null,8,["current-page","page-size","total"]),e(x,{title:"spu信息",modelValue:o(A),"onUpdate:modelValue":s[5]||(s[5]=I=>F(A)?A.value=I:A=I),"destroy-on-close":""},{default:t(()=>[e(R,null,{default:t(()=>[e(L,{span:8},{default:t(()=>s[7]||(s[7]=[_(" spu名称 ")])),_:1,__:[7]}),e(L,{span:16},{default:t(()=>[_(ne(o(c).spuName),1)]),_:1})]),_:1}),e(R,null,{default:t(()=>[e(L,{span:8},{default:t(()=>s[8]||(s[8]=[_(" spu描述 ")])),_:1,__:[8]}),e(L,{span:16},{default:t(()=>[_(ne(o(c).description),1)]),_:1})]),_:1}),e(R,null,{default:t(()=>[e(L,{span:8},{default:t(()=>s[9]||(s[9]=[_(" spu图片 ")])),_:1,__:[9]}),e(L,{span:16},{default:t(()=>[e(te,{interval:4e3,type:"card",height:"200px"},{default:t(()=>[(m(!0),$(E,null,T(o(c).spuImageList||[],(I,K)=>(m(),B(ee,{key:K},{default:t(()=>[j("img",{src:I.imgUrl,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,xe)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1})],512),[[oe,o(f)==0]]),j("div",null,[ae(e(Ve,{onChangeSence:M,row:o(c),c3Id:o(g),"onUpdate:spuImageList":Z},null,8,["row","c3Id"]),[[oe,o(f)===1]])]),j("div",null,[ae(e(Le,{onChangeSence:M},null,512),[[oe,o(f)===2]])])],64)}}}),ze=ge(Ue,[["__scopeId","data-v-946aa493"]]);export{ze as default};
